# Config to launch 3d-video training job in ScaleTorch with Charades dataset and 3D-ResNet model
# To launch run `scaletorch launch` in the current directory (samples/3d-video)

cuda: 11.6
useSpot: false

cloudProviders:
  - name: GCP
    regions:
      - us-central1
      - europe-west4
      - asia-east1
      - us-west1

gpuTypes:
  - V100

minvCPUs: 8
minMemory: 8
gpusPerTrial: 1
pythonVersion: "3.8"

environment:
  ST_PLATFORM_API: https://dev-api.storch-api.com

entrypoint: video_model_pod.py --epochs 2 --dataset_sz 1000 --batch_size 16
requirements: requirements.txt

codeTransfer:
  type: GITHUB
  repo: https://github.com/ScaleTorch/examples.git
  ref: main
  codeDir: samples/3d-video

preJobCommands:
  - apt-get update -y
  - apt-get install unzip -y
  - wget https://ai2-public-datasets.s3-us-west-2.amazonaws.com/charades/Charades.zip
  - unzip Charades.zip
  - mv Charades /mnt/Charades

useDAPP: true
dapp:
  epochs: 2

virtualMounts:
  - name: video-dataset

artifactsDestination:
  name: az-store
